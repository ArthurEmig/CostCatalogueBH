<Window x:Class="CostsViewer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CostsViewer"
        mc:Ignorable="d"
        Title="Costs Viewer" Height="720" Width="1200">
    <DockPanel>
        <ToolBar DockPanel.Dock="Top">
            <Button Content="Load File" Command="{Binding LoadFileCommand}" Margin="0,0,8,0"/>
            <Separator/>
            <TextBlock VerticalAlignment="Center" Text="Min Area:" Margin="8,0,4,0"/>
            <TextBox Width="100" Text="{Binding MinArea, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBlock VerticalAlignment="Center" Text="Max Area:" Margin="8,0,4,0"/>
            <TextBox Width="100" Text="{Binding MaxArea, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBlock VerticalAlignment="Center" Text="Project Types:" Margin="8,0,4,0"/>
            <!-- TODO: Add selectability like in Excel -->
            <ListBox Width="250" Height="80" ItemsSource="{Binding AllProjectTypes}" SelectionMode="Extended" local:SelectedItemsBehavior.SelectedItems="{Binding SelectedProjectTypes}"/>
            <ComboBox Width="120" Margin="4,0,0,0"
                      ItemsSource="{Binding ProjectTypeMatchModes}"
                      SelectedItem="{Binding ProjectTypeMatchMode, Mode=TwoWay}"/>
            <Button Content="Apply Filter" Command="{Binding ApplyFilterCommand}" Margin="8,0,0,0"/>
            <Button Content="Reset" Command="{Binding ResetFilterCommand}" Margin="4,0,0,0"/>
            <Separator/>
            <Button Content="Include Matches" Command="{Binding IncludeMatchesCommand}" Margin="8,0,0,0"/>
            <Button Content="Exclude Matches" Command="{Binding ExcludeMatchesCommand}" Margin="4,0,0,0"/>
            <Separator/>
            <Button Content="Export Excel" Command="{Binding ExportExcelCommand}" Margin="8,0,0,0"/>
            <Button Content="Export PDF" Command="{Binding ExportPdfCommand}" Margin="4,0,0,0"/>
            <Separator/>
            <Button Content="Correction Factors" Command="{Binding CorrectionFactorSettingsCommand}" Margin="8,0,0,0"/>
        </ToolBar>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="320"/>
            </Grid.ColumnDefinitions>

            <!-- Main content area with projects and summary -->
            <ScrollViewer Grid.Column="0"
                          HorizontalScrollBarVisibility="Auto"
                          VerticalScrollBarVisibility="Auto"
                          Margin="8">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Projects DataGrid -->
                    <DataGrid Grid.Row="0"
                              ItemsSource="{Binding ProjectsView}"
                              AutoGenerateColumns="False"
                              IsReadOnly="False"
                              CanUserAddRows="False"
                              SelectionMode="Extended"
                              HorizontalScrollBarVisibility="Hidden"
                              VerticalScrollBarVisibility="Hidden"
                              Margin="0,0,0,4">
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="Include" Binding="{Binding Include, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="70"/>
                            <DataGridTextColumn Header="Project ID" Binding="{Binding ProjectId}" Width="120"/>
                            <DataGridTextColumn Header="Title" Binding="{Binding ProjectTitle}" Width="200"/>
                            <DataGridTextColumn Header="Year" Binding="{Binding Year}" Width="80"/>
                            <DataGridTextColumn Header="Types" Binding="{Binding ProjectTypesDisplay}" Width="200"/>
                            <DataGridTextColumn Header="Area (sqm)" Binding="{Binding TotalArea}" Width="100"/>
                            <DataGridTextColumn Header="KG220 €/sqm" Binding="{Binding CostPerSqmKG220}" Width="100"/>
                            <DataGridTextColumn Header="KG230 €/sqm" Binding="{Binding CostPerSqmKG230}" Width="100"/>
                            <DataGridTextColumn Header="KG410 €/sqm" Binding="{Binding CostPerSqmKG410}" Width="100"/>
                            <DataGridTextColumn Header="KG420 €/sqm" Binding="{Binding CostPerSqmKG420}" Width="100"/>
                            <DataGridTextColumn Header="KG430 €/sqm" Binding="{Binding CostPerSqmKG430}" Width="100"/>
                            <DataGridTextColumn Header="KG434 €/sqm" Binding="{Binding CostPerSqmKG434}" Width="100"/>
                            <DataGridTextColumn Header="KG440 €/sqm" Binding="{Binding CostPerSqmKG440}" Width="100"/>
                            <DataGridTextColumn Header="KG450 €/sqm" Binding="{Binding CostPerSqmKG450}" Width="100"/>
                            <DataGridTextColumn Header="KG460 €/sqm" Binding="{Binding CostPerSqmKG460}" Width="100"/>
                            <DataGridTextColumn Header="KG474 €/sqm" Binding="{Binding CostPerSqmKG474}" Width="100"/>
                            <DataGridTextColumn Header="KG475 €/sqm" Binding="{Binding CostPerSqmKG475}" Width="100"/>
                            <DataGridTextColumn Header="KG480 €/sqm" Binding="{Binding CostPerSqmKG480}" Width="100"/>
                            <DataGridTextColumn Header="KG490 €/sqm" Binding="{Binding CostPerSqmKG490}" Width="100"/>
                            <DataGridTextColumn Header="KG550 €/sqm" Binding="{Binding CostPerSqmKG550}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Summary Section -->
                    <Border Grid.Row="1" BorderBrush="Gray" BorderThickness="1" Margin="0,4,0,0" Background="White">
                        <StackPanel Orientation="Vertical" Margin="4">
                            <TextBlock Text="Cost Group Summary (DIN 276)" FontWeight="Bold" FontSize="14" Margin="4,4,4,8" HorizontalAlignment="Center"/>

                            <!-- Summary Grid with columns matching the DataGrid above -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <!-- Match the DataGrid column widths -->
                                    <ColumnDefinition Width="70"/>   <!-- Include -->
                                    <ColumnDefinition Width="120"/>  <!-- Project ID -->
                                    <ColumnDefinition Width="200"/>  <!-- Title -->
                                    <ColumnDefinition Width="80"/>   <!-- Year -->
                                    <ColumnDefinition Width="200"/>  <!-- Types -->
                                    <ColumnDefinition Width="100"/>  <!-- Area -->
                                    <ColumnDefinition Width="100"/>  <!-- KG220 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG230 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG410 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG420 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG430 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG434 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG440 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG450 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG460 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG474 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG475 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG480 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG490 -->
                                    <ColumnDefinition Width="100"/>  <!-- KG550 -->
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Cost Group Headers -->
                                <TextBlock Grid.Column="5" Grid.Row="0" Text="Area" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="6" Grid.Row="0" Text="KG220" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="7" Grid.Row="0" Text="KG230" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="8" Grid.Row="0" Text="KG410" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="9" Grid.Row="0" Text="KG420" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="10" Grid.Row="0" Text="KG430" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="11" Grid.Row="0" Text="KG434" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="12" Grid.Row="0" Text="KG440" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="13" Grid.Row="0" Text="KG450" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="14" Grid.Row="0" Text="KG460" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="15" Grid.Row="0" Text="KG474" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="16" Grid.Row="0" Text="KG475" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="17" Grid.Row="0" Text="KG480" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="18" Grid.Row="0" Text="KG490" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>
                                <TextBlock Grid.Column="19" Grid.Row="0" Text="KG550" FontWeight="Bold" HorizontalAlignment="Center" Margin="2"/>

                                <!-- Headers for summary rows -->
                                <TextBlock Grid.Column="4" Grid.Row="1" Text="Count:" FontWeight="Bold" HorizontalAlignment="Right" Margin="2"/>
                                <TextBlock Grid.Column="4" Grid.Row="2" Text="Average:" FontWeight="Bold" HorizontalAlignment="Right" Margin="2"/>
                                <TextBlock Grid.Column="4" Grid.Row="3" Text="Min:" FontWeight="Bold" HorizontalAlignment="Right" Margin="2"/>
                                <TextBlock Grid.Column="4" Grid.Row="4" Text="Max:" FontWeight="Bold" HorizontalAlignment="Right" Margin="2"/>
                                <TextBlock Grid.Column="4" Grid.Row="5" Text="Std Dev:" FontWeight="Bold" HorizontalAlignment="Right" Margin="2"/>
                                <TextBlock Grid.Column="4" Grid.Row="6" Text="Corrected Avg:" FontWeight="Bold" HorizontalAlignment="Right" Margin="2" Foreground="Blue"/>

                                <!-- Count row -->
                                <TextBlock Grid.Column="5" Grid.Row="1" Text="{Binding IncludedCount}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Count of included projects"/>

                                <!-- Area column -->
                                <TextBlock Grid.Column="5" Grid.Row="2" Text="{Binding AverageArea, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average Area"/>

                                <!-- KG220 column -->
                                <TextBlock Grid.Column="6" Grid.Row="2" Text="{Binding AverageKG220, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG220"/>
                                <TextBlock Grid.Column="6" Grid.Row="3" Text="{Binding MinKG220, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG220"/>
                                <TextBlock Grid.Column="6" Grid.Row="4" Text="{Binding MaxKG220, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG220"/>

                                <!-- KG230 column -->
                                <TextBlock Grid.Column="7" Grid.Row="2" Text="{Binding AverageKG230, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG230"/>
                                <TextBlock Grid.Column="7" Grid.Row="3" Text="{Binding MinKG230, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG230"/>
                                <TextBlock Grid.Column="7" Grid.Row="4" Text="{Binding MaxKG230, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG230"/>

                                <!-- KG410 column -->
                                <TextBlock Grid.Column="8" Grid.Row="2" Text="{Binding AverageKG410, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG410"/>
                                <TextBlock Grid.Column="8" Grid.Row="3" Text="{Binding MinKG410, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG410"/>
                                <TextBlock Grid.Column="8" Grid.Row="4" Text="{Binding MaxKG410, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG410"/>

                                <!-- KG420 column -->
                                <TextBlock Grid.Column="9" Grid.Row="2" Text="{Binding AverageKG420, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG420"/>
                                <TextBlock Grid.Column="9" Grid.Row="3" Text="{Binding MinKG420, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG420"/>
                                <TextBlock Grid.Column="9" Grid.Row="4" Text="{Binding MaxKG420, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG420"/>

                                <!-- KG430 column -->
                                <TextBlock Grid.Column="10" Grid.Row="2" Text="{Binding AverageKG430, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG430"/>
                                <TextBlock Grid.Column="10" Grid.Row="3" Text="{Binding MinKG430, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG430"/>
                                <TextBlock Grid.Column="10" Grid.Row="4" Text="{Binding MaxKG430, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG430"/>

                                <!-- KG434 column -->
                                <TextBlock Grid.Column="11" Grid.Row="2" Text="{Binding AverageKG434, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG434"/>
                                <TextBlock Grid.Column="11" Grid.Row="3" Text="{Binding MinKG434, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG434"/>
                                <TextBlock Grid.Column="11" Grid.Row="4" Text="{Binding MaxKG434, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG434"/>

                                <!-- KG440 column -->
                                <TextBlock Grid.Column="12" Grid.Row="2" Text="{Binding AverageKG440, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG440"/>
                                <TextBlock Grid.Column="12" Grid.Row="3" Text="{Binding MinKG440, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG440"/>
                                <TextBlock Grid.Column="12" Grid.Row="4" Text="{Binding MaxKG440, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG440"/>

                                <!-- KG450 column -->
                                <TextBlock Grid.Column="13" Grid.Row="2" Text="{Binding AverageKG450, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG450"/>
                                <TextBlock Grid.Column="13" Grid.Row="3" Text="{Binding MinKG450, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG450"/>
                                <TextBlock Grid.Column="13" Grid.Row="4" Text="{Binding MaxKG450, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG450"/>

                                <!-- KG460 column -->
                                <TextBlock Grid.Column="14" Grid.Row="2" Text="{Binding AverageKG460, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG460"/>
                                <TextBlock Grid.Column="14" Grid.Row="3" Text="{Binding MinKG460, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG460"/>
                                <TextBlock Grid.Column="14" Grid.Row="4" Text="{Binding MaxKG460, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG460"/>

                                <!-- KG474 column -->
                                <TextBlock Grid.Column="15" Grid.Row="2" Text="{Binding AverageKG474, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG474"/>
                                <TextBlock Grid.Column="15" Grid.Row="3" Text="{Binding MinKG474, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG474"/>
                                <TextBlock Grid.Column="15" Grid.Row="4" Text="{Binding MaxKG474, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG474"/>

                                <!-- KG475 column -->
                                <TextBlock Grid.Column="16" Grid.Row="2" Text="{Binding AverageKG475, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG475"/>
                                <TextBlock Grid.Column="16" Grid.Row="3" Text="{Binding MinKG475, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG475"/>
                                <TextBlock Grid.Column="16" Grid.Row="4" Text="{Binding MaxKG475, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG475"/>

                                <!-- KG480 column -->
                                <TextBlock Grid.Column="17" Grid.Row="2" Text="{Binding AverageKG480, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG480"/>
                                <TextBlock Grid.Column="17" Grid.Row="3" Text="{Binding MinKG480, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG480"/>
                                <TextBlock Grid.Column="17" Grid.Row="4" Text="{Binding MaxKG480, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG480"/>

                                <!-- KG490 column -->
                                <TextBlock Grid.Column="18" Grid.Row="2" Text="{Binding AverageKG490, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG490"/>
                                <TextBlock Grid.Column="18" Grid.Row="3" Text="{Binding MinKG490, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG490"/>
                                <TextBlock Grid.Column="18" Grid.Row="4" Text="{Binding MaxKG490, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG490"/>

                                <!-- KG550 column -->
                                <TextBlock Grid.Column="19" Grid.Row="2" Text="{Binding AverageKG550, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Average KG550"/>
                                <TextBlock Grid.Column="19" Grid.Row="3" Text="{Binding MinKG550, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Min KG550"/>
                                <TextBlock Grid.Column="19" Grid.Row="4" Text="{Binding MaxKG550, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Max KG550"/>

                                <!-- Standard Deviation row for all cost groups -->
                                <TextBlock Grid.Column="6" Grid.Row="5" Text="{Binding StdDevKG220, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG220"/>
                                <TextBlock Grid.Column="7" Grid.Row="5" Text="{Binding StdDevKG230, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG230"/>
                                <TextBlock Grid.Column="8" Grid.Row="5" Text="{Binding StdDevKG410, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG410"/>
                                <TextBlock Grid.Column="9" Grid.Row="5" Text="{Binding StdDevKG420, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG420"/>
                                <TextBlock Grid.Column="10" Grid.Row="5" Text="{Binding StdDevKG430, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG430"/>
                                <TextBlock Grid.Column="11" Grid.Row="5" Text="{Binding StdDevKG434, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG434"/>
                                <TextBlock Grid.Column="12" Grid.Row="5" Text="{Binding StdDevKG440, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG440"/>
                                <TextBlock Grid.Column="13" Grid.Row="5" Text="{Binding StdDevKG450, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG450"/>
                                <TextBlock Grid.Column="14" Grid.Row="5" Text="{Binding StdDevKG460, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG460"/>
                                <TextBlock Grid.Column="15" Grid.Row="5" Text="{Binding StdDevKG474, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG474"/>
                                <TextBlock Grid.Column="16" Grid.Row="5" Text="{Binding StdDevKG475, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG475"/>
                                <TextBlock Grid.Column="17" Grid.Row="5" Text="{Binding StdDevKG480, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG480"/>
                                <TextBlock Grid.Column="18" Grid.Row="5" Text="{Binding StdDevKG490, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG490"/>
                                <TextBlock Grid.Column="19" Grid.Row="5" Text="{Binding StdDevKG550, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="Transparent" ToolTip="Std Dev KG550"/>

                                <!-- Corrected Average row for all cost groups -->
                                <TextBlock Grid.Column="6" Grid.Row="6" Text="{Binding CorrectedAverageKG220, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG220" Foreground="Blue"/>
                                <TextBlock Grid.Column="7" Grid.Row="6" Text="{Binding CorrectedAverageKG230, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG230" Foreground="Blue"/>
                                <TextBlock Grid.Column="8" Grid.Row="6" Text="{Binding CorrectedAverageKG410, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG410" Foreground="Blue"/>
                                <TextBlock Grid.Column="9" Grid.Row="6" Text="{Binding CorrectedAverageKG420, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG420" Foreground="Blue"/>
                                <TextBlock Grid.Column="10" Grid.Row="6" Text="{Binding CorrectedAverageKG430, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG430" Foreground="Blue"/>
                                <TextBlock Grid.Column="11" Grid.Row="6" Text="{Binding CorrectedAverageKG434, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG434" Foreground="Blue"/>
                                <TextBlock Grid.Column="12" Grid.Row="6" Text="{Binding CorrectedAverageKG440, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG440" Foreground="Blue"/>
                                <TextBlock Grid.Column="13" Grid.Row="6" Text="{Binding CorrectedAverageKG450, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG450" Foreground="Blue"/>
                                <TextBlock Grid.Column="14" Grid.Row="6" Text="{Binding CorrectedAverageKG460, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG460" Foreground="Blue"/>
                                <TextBlock Grid.Column="15" Grid.Row="6" Text="{Binding CorrectedAverageKG474, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG474" Foreground="Blue"/>
                                <TextBlock Grid.Column="16" Grid.Row="6" Text="{Binding CorrectedAverageKG475, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG475" Foreground="Blue"/>
                                <TextBlock Grid.Column="17" Grid.Row="6" Text="{Binding CorrectedAverageKG480, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG480" Foreground="Blue"/>
                                <TextBlock Grid.Column="18" Grid.Row="6" Text="{Binding CorrectedAverageKG490, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG490" Foreground="Blue"/>
                                <TextBlock Grid.Column="19" Grid.Row="6" Text="{Binding CorrectedAverageKG550, StringFormat={}{0:F0}}" HorizontalAlignment="Center" Margin="2" Background="LightBlue" ToolTip="Corrected Average KG550" Foreground="Blue"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                </Grid>
            </ScrollViewer>

            <!-- Right panel with Averages and Corrected tabs -->
            <TabControl Grid.Column="1" Margin="8">
                <TabItem Header="Original Averages">
                    <StackPanel Orientation="Vertical" Margin="8">
                        <TextBlock Text="Original Included Averages" FontWeight="Bold" FontSize="16" Margin="0,0,0,8"/>
                        <UniformGrid Columns="2" Margin="0,0,0,8">
                            <TextBlock Text="Count:"/>
                            <TextBlock Text="{Binding IncludedCount}"/>
                            <TextBlock Text="Area Avg:"/>
                            <TextBlock Text="{Binding AverageArea, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG220 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG220, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG230 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG230, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG410 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG410, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG420 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG420, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG430 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG430, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG434 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG434, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG440 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG440, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG450 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG450, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG460 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG460, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG474 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG474, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG475 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG475, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG480 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG480, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG490 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG490, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG550 €/sqm:"/>
                            <TextBlock Text="{Binding AverageKG550, StringFormat={}{0:F0}}"/>
                        </UniformGrid>
                    </StackPanel>
                </TabItem>
                <TabItem Header="Corrected Averages">
                    <StackPanel Orientation="Vertical" Margin="8">
                        <TextBlock Text="Corrected Included Averages" FontWeight="Bold" FontSize="16" Margin="0,0,0,8" Foreground="Blue"/>
                        <TextBlock Text="(After applying correction factors)" FontSize="12" Margin="0,0,0,8" Foreground="Gray"/>
                        <UniformGrid Columns="2" Margin="0,0,0,8">
                            <TextBlock Text="Count:"/>
                            <TextBlock Text="{Binding IncludedCount}"/>
                            <TextBlock Text="Area Avg:"/>
                            <TextBlock Text="{Binding AverageArea, StringFormat={}{0:F0}}"/>
                            <TextBlock Text="KG220 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG220, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG230 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG230, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG410 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG410, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG420 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG420, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG430 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG430, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG434 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG434, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG440 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG440, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG450 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG450, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG460 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG460, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG474 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG474, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG475 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG475, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG480 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG480, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG490 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG490, StringFormat={}{0:F0}}" Foreground="Blue"/>
                            <TextBlock Text="KG550 €/sqm:" Foreground="Blue"/>
                            <TextBlock Text="{Binding CorrectedAverageKG550, StringFormat={}{0:F0}}" Foreground="Blue"/>
                        </UniformGrid>
                    </StackPanel>
                </TabItem>
            </TabControl>
        </Grid>
    </DockPanel>
</Window>
